{% extends 'base.html' %}
{% block content %}
<div class="practice_container">
    {% if form %}
    <nav class="practice_nav">
        <div><a class="nav_link_selected" href="{% url 'practice' %}">합주 불참 신청</a></div>
        {% if user.is_authenticated %}
        <div><a class="nav_link" href="{% url 'setting' %}">관리</a></div>
        {% endif %}
    </nav>
    <form method="POST" class="practice_form">
        {% csrf_token %}
            {% for field in form %}
                <div class="practice_field">
                    <div class="practice_label">{{field.label}}</div>
                    <div class="practice_input">{{field}}</div>
                    {% for error in field.errors %}
                    <div class="practice_error"><b style="color: red;">{{error}}</b></div>
                    {% endfor %}
                </div>
            {% endfor %}
            
            <div id="practice_info">
                합주에 참여할 수 <b style="color: red;">없는</b> 시간을 모두 선택해주세요. <br>
                수정이 필요한 경우 다시 제출해주세요.
            </div>
            <div>
                {% for choice in choices %}
                {% if choice.0 %}
                    <div class="practice_choice">
                        <input type="checkbox" name="selected" value="{{choice.0}}">{{choice.1}}
                    </div>
                
                {% else %}
                    </div>
                    <div class="choice_wrapper">
                    <div class="practice_choice_date">
                        {{choice.1}}
                    </div>
                    <div class="practice_choice" style="color: crimson;">
                        <input type="checkbox" name="selectall" value="selectall" onclick="selectAll(this)">(전체선택)
                    </div>
                {% endif %}
                {% endfor %}
            </div>

            <div class="submit-wrapper">

                <input type="submit" value="제출"><br>
            </div>
        
    </form>
    
    {% else %}
        예정된 합주가 없습니다. 잠시만 기다려주세요 :)
    {% endif %}



</div>
<script type="text/javascript">
    function selectAll(selectAll) {
        const checkboxes = selectAll.parentElement.parentElement.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach((checkbox) => {
            checkbox.checked = selectAll.checked
        })
    }
</script>

{% if message %}
    <script>
            alert("{{message}}");
    </script>
{% endif %}

{% endblock %}